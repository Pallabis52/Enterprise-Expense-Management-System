spring.application.name=Expense Management

# ── Startup & Performance Optimizations 
spring.main.banner-mode=off
spring.jpa.open-in-view=false

# ── Database Pool Optimization (Strictly limit threads) 
# Each connection in the pool uses memory and a thread. 
# Reducing this to 5 is plenty for dev and much safer for 6GB systems.
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.idle-timeout=30000
spring.datasource.hikari.max-lifetime=1800000

# Database Configuration
# Database Configuration
spring.datasource.url=jdbc:postgresql://localhost:5432/expense_management
spring.datasource.username=postgres
spring.datasource.password=Aditya
spring.datasource.driver-class-name=org.postgresql.Driver
spring.jpa.hibernate.ddl-auto=update
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=true


# File upload configuration
app.file.upload-dir=uploads
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=20MB

server.port=8081

# ── Secure AI Configuration (External vs Local) ──────────────────────────────
# Provider: OPENROUTER or OLLAMA
ai.provider=${AI_PROVIDER:OPENROUTER}
ai.api-key=${AI_API_KEY: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}
ai.base-url=${AI_BASE_URL:https://openrouter.ai/api/v1}
ai.model=${AI_MODEL:google/gemini-2.0-flash-001}

# ── legacy properties (fallback/compatibility) ──
openrouter.api.key=${AI_API_KEY:}
openrouter.model=${AI_MODEL:google/gemini-2.0-flash-001}
openrouter.base-url=${AI_BASE_URL:https://openrouter.ai/api/v1}
openrouter.timeout-seconds=60
openrouter.connect-timeout-seconds=10

# ── Ollama AI (Fallback Engine) ─────────────────────────────────────────
# ollama.base-url=http://127.0.0.1:11434
# ollama.model=phi3:latest
# ollama.light-model=phi3:latest
# ollama.timeout-seconds=90
# ollama.warmup.enabled=false

# ── AI Response Cache (Caffeine) ─────────────────────────────────────────────
# 5-minute TTL, max 200 cached entries — no Redis needed
spring.cache.type=caffeine
spring.cache.caffeine.spec=maximumSize=200,expireAfterWrite=5m

# ── DevTools — disabled to save native memory ───
# ollama.async.enabled=true

# ── Security & Diagnostic Logging ─────────────────────────────────────────────
logging.level.com.expensemanagement.security=DEBUG
logging.level.org.springframework.security=DEBUG
logging.level.org.springframework.security.web.access=DEBUG
# AUTH-DIAGNOSTIC is active in the JwtAuthenticationFilter code
